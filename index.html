<!DOCTYPE html>
<html>

<head>
  <title>Octopus Agile Daily Price & Consumption Tracker</title>
  <meta name="description" content="Track Octopus Agile prices and your daily energy consumption with our easy-to-use tracker.">
  <meta name="keywords" content="Octopus Energy, Agile Prices, Energy Consumption, Energy Tracker, Octopus Agile, Energy Prices, Consumption Tracker">
  <meta name="author" content="Tiny Blue Robots">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@1.0.2/css/bulma.min.css">
  <script type="module">
    import * as app from '/build/d22hhg04.js'
    window.app = app
  </script>
  <script type="module" src="https://cdn.jsdelivr.net/gh/starfederation/datastar@v1.0.0-beta.1/bundles/datastar.js"></script>
  <style>
    html,
    option,
    .modal-card-head,
    .modal-card-body,
    .modal-card-foot,
    .button {
      background-color: rgb(16 0 48) !important
    }

    .button,
    input {
      color: azure !important;
    }

    .button:hover {
      border-color: rgb(240 80 248) !important;
    }

    #chart {
      background-color: rgb(24 0 72);
    }

    .tag {
      background-color: rgb(88 64 255) !important;
      color: azure !important;
    }

    .is-info {
      background-color: rgb(240 80 248) !important;
    }

    a {
      color: rgb(240 80 248) !important;
    }

    header a {
      color: azure !important;
    }
  </style>
</head>

<body class="container">
  <header class="section">
    <h1 class="title has-text-centered"><a href="/">Octopus Agile Daily Price & Consumption Tracker</a></h1>
  </header>
  <main class="box has-background-inherit" data-signals-totals="''" data-on-totalsupdated__window="$totals = evt.detail" data-replace-url="$periodfrom != new Date().toISOString().split('T')[0] ? `?periodfrom=${$periodfrom}` : '/'" data-computed-nextdatedisabled="$periodfrom == $maxperiodfrom" data-computed-maxperiodfrom="$periodfrom && app.getMaxPeriodFrom()" data-signals-periodfrom="app.getMaxPeriodFrom(window.location.search)" data-signals-account="app.getAccount()" data-signals-token="app.getToken()" data-signals-region="app.getRegion() || 'A'" data-persist="account token region" data-signals-rendercharts="() => app.renderCharts($region, $periodfrom, $account, $token)" data-on-load="app.onload($rateschart, $costchart, $rendercharts)">
    <div class="columns">
      <div class="column is-11">
        <div class="field">
          <label for="region" class="label">Region</label>
          <div class="control">
            <div class="select" class="has-background-inherit">
              <select id="region" class="has-background-inherit" data-bind="region" data-on-change="$rendercharts()">
                <option value="A">Eastern England</option>
                <option value="B">East Midlands</option>
                <option value="C">London</option>
                <option value="D">North Wales, Merseyside and Cheshire</option>
                <option value="E">West Midlands</option>
                <option value="F">North East England</option>
                <option value="G">North West England</option>
                <option value="H">Southern England</option>
                <option value="J">South East England</option>
                <option value="K">South Wales</option>
                <option value="L">South West England</option>
                <option value="M">Yorkshire</option>
                <option value="N">Southern Scotland</option>
                <option value="P">Northern Scotland</option>
              </select>
            </div>
          </div>
        </div>
        <div class="field">
          <label for="periodfrom" class="label">Date</label>
          <span data-on-click="$periodfrom = app.setPreviousDay($periodfrom); $rendercharts()" class="button has-background-inherit">&lt;&lt;</span>
          <input id="periodfrom" type="date" data-bind-periodfrom data-attributes-max="$maxperiodfrom" class="button has-background-inherit" data-on-change="app.renderCharts($region, $periodfrom)" />
          <span data-on-click="$periodfrom = app.setNextDay($periodfrom, $maxperiodfrom); $rendercharts()" class="button has-background-inherit" data-attributes-disabled="$nextdatedisabled">&gt;&gt;</span>
        </div>
      </div>
      <div class="column">
        <div class="field" data-class-is-hidden="!$account">
          <label class="label">Account</label>
          <span data-text="$account"></span>
        </div>
        <button class="button" data-class-is-hidden="$account" data-on-click="$signinmodalactive = true">Sign In</button>
        <button class="button" data-class-is-hidden="!$account" data-on-click="$account = $token = ''; app.signOut(); $rendercharts()">Sign Out</button>
      </div>
    </div>
    <div class="field is-grouped is-grouped-multiline" data-class-is-hidden="!$totals">
      <div class="control">
        <div class="tags has-addons">
          <span class="tag">Total cost</span>
          <span class="tag is-info" data-text="`£${$totals.totalCost}`"></span>
        </div>
      </div>
      <div class="control">
        <div class="tags has-addons">
          <span class="tag">Total kWh</span>
          <span class="tag is-info" data-text="`${$totals.totalKwh}`"></span>
        </div>
      </div>
      <div class="control">
        <div class="tags has-addons">
          <span class="tag">Average kWh cost</span>
          <span class="tag is-info" data-text="`£${$totals.averageKwhCost}`"></span>
        </div>
      </div>
    </div>
    <div data-ref-rateschart></div>
    <br>
    <div data-ref-costchart></div>
  </main>
  <footer class="footer has-background-inherit">
    <div class="has-text-centered box has-background-inherit">
      <p>
        Not on Agile? <a href="https://share.octopus.energy/rich-moon-324" target="_blank">Switch to Octopus Energy</a> and get £50 credit.
      </p>
      <p>
        This site is not affiliated with Octopus Energy. It uses the <a href="https://developer.octopus.energy" target="_blank">Octopus Energy API</a> to display Agile tariff prices and consumption data.
      </p>
      <p data-class-is-hidden="$account">
        <a href="#" data-on-click="$signinmodalactive = true">Sign in</a> to see your consumption data. Your account and token will only be stored in your browser's local storage.
      </p>
      <p>
        Built by <a href="https://tinybluerobots.com" target="_blank">Tiny Blue Robots</a>. Found a bug or want to suggest a feature? <a href="mailto:info@tinybluerobots.com">Let us know</a>.
      </p>
    </div>
  </footer>
  <div class="modal" data-bind-signinmodalactive data-class-is-active="$signinmodalactive">
    <div class="modal-background"></div>
    <div class="modal-card">
      <header class="modal-card-head">
        <p class="modal-card-title">Sign in</p>
        <button class="delete" aria-label="close" data-on-click="$signinmodalactive = false"></button>
      </header>
      <section class="modal-card-body">
        <label for="account" class="label">Account</label>
        <input id="account" type="text" class="input has-background-inherit" data-bind-signinaccount />
        <label for="token" class="label">Token</label>
        <input id="token" type="text" class="input has-background-inherit" data-bind-signintoken />
      </section>
      <footer class="modal-card-foot">
        <div class="buttons">
          <button class="button" data-on-click="app.signIn($signinaccount, $signintoken).then(result => result && ($account = $signinaccount) && ($token = $signintoken) && ($signinmodalactive = !result)).then(() => $rendercharts())">Ok</button>
          <button class="button" data-on-click="$signinmodalactive = false">Cancel</button>
        </div>
      </footer>
    </div>
  </div>
</body>

</html>